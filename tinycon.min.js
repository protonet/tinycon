/*!
 * Tinycon - A small library for manipulating the Favicon
 * Tom Moor, http://tommoor.com
 * Copyright (c) 2012 Tom Moor
 * MIT Licensed
 * @version 0.5
 *
 * Forked by Christopher Blum: https://github.com/protonet/tinycon
*/
(function(){var f={},l=null,m=null,q=document.title,h=null,k=null,d={},n={width:7,height:9,font:"10px arial",colour:"#ffffff",background:"#F03D25",fallback:!0,abbreviate:!0},c,t=navigator.userAgent.toLowerCase();c=function(a){return-1!==t.indexOf(a)};var u=c("msie");c("chrome");var v=c("chrome")||c("safari"),w=c("safari")&&!c("chrome"),x=c("mozilla")&&!c("chrome")&&!c("safari"),r=function(){return u||w||"force"===d.fallback||!j().getContext},j=function(){k||(k=document.createElement("canvas"),k.width=
16,k.height=16);return k},p=function(a){for(var e=document.getElementsByTagName("link"),b=document.getElementsByTagName("head")[0],d=0,c=e.length;d<c;d++)"undefined"!==typeof e[d]&&(e[d].getAttribute("rel")||"").match(/\bicon\b/)&&b.removeChild(e[d]);e=document.createElement("link");e.type="image/x-icon";e.rel="icon";e.href=a;document.getElementsByTagName("head")[0].appendChild(e)},s=function(a){d.fallback&&(document.title=0<(a+"").length?"("+a+") "+q:q)};f.setOptions=function(a){d={};for(var e in n)d[e]=
a.hasOwnProperty(e)?a[e]:n[e];return this};f.setImage=function(a){l=a;j().getContext&&p(j().toDataURL());return this};f.setBubble=function(a){var e=a||"";if(r())s(e);else{var b=j().getContext("2d");if(!m||!l){b:{a=document.getElementsByTagName("link");for(var c=0,f=a.length;c<f;c++)if((a[c].getAttribute("rel")||"").match(/\bicon\b/)){a=a[c];break b}a=!1}m=l=a?a.getAttribute("href"):"/favicon.ico"}a=l;h=new Image;h.onload=function(){b.clearRect(0,0,16,16);b.drawImage(h,0,0,h.width,h.height,0,0,16,
16);if(0<(e+"").length){var a=e;if("number"==typeof a&&99<a&&d.abbreviate)for(var c=[["G",1E9],["M",1E6],["k",1E3]],g=0;g<c.length;++g)if(a>=c[g][1]){a=(new Number(a/c[g][1])).toFixed(void 0)+c[g][0];break}var c=d.width+6*((a+"").length-1),g=16-c,f=16-d.height;b.font=(v?"bold ":"")+d.font;b.fillStyle=d.background;b.strokeStyle=d.background;b.lineWidth=1;b.fillRect(g,f,c-1,d.height);b.beginPath();b.moveTo(g-0.5,f+1);b.lineTo(g-0.5,15);b.stroke();b.beginPath();b.moveTo(15.5,f+1);b.lineTo(15.5,15);b.stroke();
b.beginPath();b.strokeStyle="rgba(0,0,0,0.3)";b.moveTo(g,16);b.lineTo(15,16);b.stroke();b.fillStyle=d.colour;b.textAlign="right";b.textBaseline="top";b.fillText(a,15,x?7:6)}j().getContext&&p(j().toDataURL())};a.match(/^data/)||(h.crossOrigin="anonymous");h.src=a}return this};f.reset=function(){if(r())return s("");p(m)};f.setOptions(n);window.Tinycon=f})();